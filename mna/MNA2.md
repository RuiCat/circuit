# 改进节点分析 - 介绍

虽然节点电压法和回路电流法是最广泛教授的方法，但另一种强大的方法是改进节点分析（MNA）。MNA通常比其他方法产生更大的方程组，但更容易在计算机上算法实现，这对于自动化求解是一个重要优势。要使用改进节点分析，您为每个未连接到电压源的节点写一个方程（如标准节点分析），并用每个电压源的方程来增强这些方程。更具体地说，标准节点分析的规则如下所示：

## 节点电压法

要将节点电压法应用于具有n个节点（有m个电压源）的电路，请执行以下步骤（根据Rizzoni）：

1. 选择一个参考节点（通常是地）。
2. 命名剩余的n-1个节点，并标记通过每个无源元件和每个电流源的电流。
3. 将基尔霍夫电流定律应用于每个未连接到电压源的节点。
4. 求解n-1-m个未知电压的系统。

这种方法的困难在于必须考虑电压源的影响。要么为每个源写一个单独的方程，要么必须使用超节点方法。

改进节点分析的规则由以下给出：

## 改进节点分析

要将节点电压法应用于具有n个节点（有m个电压源）的电路，请执行以下步骤（根据DeCarlo/Lin）：

1. 选择一个参考节点（通常是地）并命名剩余的n-1个节点。还要标记通过每个电流源的电流。
2. 为通过每个电压源的电流分配一个名称。我们将使用电流从源的正节点流向负节点的约定。
3. 将基尔霍夫电流定律应用于每个节点。我们将取流出节点的电流为正。
4. 为每个电压源写一个电压方程。
5. 求解n-1个未知数的系统。

注意：我只讨论独立电流源和电压源。受控源是一个简单的扩展。有关参考，请参见Litovski或DeCarlo/Lin。

作为一个示例，考虑下面的电路（来自上一个文档）

### 示例1

考虑下面所示的电路（步骤1已经应用）

应用步骤2（通过电压源的电流，从正节点流向负节点）：

应用步骤3（正电流流出节点）：
```
节点a: iv1 + (va - vb)/R1 = 0
节点b: (vb - va)/R1 + vb/R3 + (vb - vc)/R2 = 0
节点c: iv2 + (vc - vb)/R2 = 0
```

应用步骤4：
```
va = V1
vc = V2
```

应用步骤5：
```
iv1 + (va - vb)/R1 = 0
(vb - va)/R1 + vb/R3 + (vb - vc)/R2 = 0
iv2 + (vc - vb)/R2 = 0
va = V1
vc = V2
```

或
```
[1/R1, -1/R1, 0, 1, 0;
 -1/R1, 1/R1 + 1/R2 + 1/R3, -1/R2, 0, 0;
 0, -1/R2, 1/R2, 0, 1;
 1, 0, 0, 0, 0;
 0, 0, 1, 0, 0] * [va; vb; vc; iv1; iv2] = [0; 0; 0; V1; V2]
```

现在剩下的就是求解5x5方程组（回想一下节点分析方法只产生1个方程，尽管在那种情况下我们沿途进行了一些替换）。手工求解5x5方程很困难，但用计算机就不那么困难了。

### 示例2

如果您还记得，当电压源中的一个或多个未连接到地时，节点分析方法变得有点困难。让我们用MNA重复上一页的示例2。这里重复了电路，步骤1和2已完成：

步骤3和4：
```
va/R1 - iv1 = 0
iv1 + vb/R3 + (vb - vc)/R2 = 0
iv2 + (vc - vb)/R2 = 0
vb - va = V1
vc = V2
```

步骤5：
```
[1/R1, 0, 0, -1, 0;
 0, 1/R2 + 1/R3, -1/R2, 1, 0;
 0, -1/R2, 1/R2, 0, 1;
 -1, 1, 0, 0, 0;
 0, 0, 1, 0, 0] * [va; vb; vc; iv1; iv2] = [0; 0; 0; V1; V2]
```

V1未接地的事实完全没有造成困难。

### 示例3

让我们再考虑一个示例，这次有一个电流源（这个示例来自Litovski）。步骤1和2已完成。

现在完成步骤3和4：
```
-Is1 + v1/R1 + IVs1 + (v1 - v2)/R2 = 0 (节点1)
-IVs1 + (v2 - v1)/R2 + v2/R3 = 0 (节点2)
v1 - v2 = Vs1 (Vs1)
```

最后将所有已知变量移到右侧并完成步骤5：
```
[1/R1 + 1/R2, -1/R2, 1;
 -1/R2, 1/R2 + 1/R3, -1;
 1, -1, 0] * [v1; v2; IVs1] = [Is1; 0; Vs1]
```

## 关于MNA的观察

如果您检查应用MNA方法产生的矩阵方程，几个模式变得明显，我们可以用来开发算法。所有电路都产生了形式为的方程：
```
Ax = z
```

让我们检查示例2。这个电路有3个节点和2个电压源（n=3，m=2）。得到的矩阵如下所示。

注意A矩阵的粉色突出部分是3×3（通常为n×n），并且只包括已知量，特别是无源元件（电阻）的值。此外，A矩阵的突出部分是对称的，主对角线上有正值，非对角线项只有负（或零）值。如果一个元件连接到地，它只出现在对角线上；一个未接地的（例如R2）同时出现在对角线上和非对角线上。A矩阵的其余部分（未突出显示的部分）只包含1、-1和0。还要注意矩阵大小是5x5（通常为(m+n)×(m+n)）。对于我们分析的所有电路（即只有无源元件和独立源），关于A矩阵的这些一般观察将始终成立。

现在考虑x矩阵，未知量的矩阵。它是一个5×1矩阵（通常为(n+m)×1）。最上面的3个（通常为n）元素只是节点电压。最下面的2个（通常为m）元素是与电压源相关的电流。

这使我们来到z矩阵，它只包含已知量。它也是一个5×1矩阵（通常为(n+m)×1）。最上面的3个（通常为n）元素要么是零，要么是独立电流源的总和（参见示例3的情况）。最下面的2个（通常为m）元素是独立电压源。

## 总结

应用于只有无源元件（电阻）和独立电流源和电压源的电路的MNA产生形式为的矩阵方程：
```
Ax = z
```

对于具有n个节点和m个独立电压源的电路：

- **A矩阵**：
  - 大小为(m+n)×(m+n)，并且只由已知量组成。
  - 矩阵左上角的n×n部分：
    - 只有无源元件
    - 连接到地的元件只出现在对角线上
    - 未连接到地的元件同时出现在对角线上和非对角线项上。
  - A矩阵的其余部分（不包括在n×n左上部分中）只包含1、-1和0（如果有受控电流源和电压源，可能有其他值；我没有考虑这些情况。如果有兴趣，请咨询Litovski。）
- **x矩阵**：
  - 是一个(n+m)×1向量，保存未知量（节点电压和通过独立电压源的电流）。
  - 最上面的n个元素是n个节点电压。
  - 最下面的m个元素代表电路中m个独立电压源的电流。
- **z矩阵**：
  - 是一个(n+m)×1向量，只保存已知量
  - 最上面的n个元素要么是零，要么是电路中独立电流源的总和和差。
  - 最下面的m个元素代表电路中m个独立电压源。

电路通过简单的矩阵操作求解：
```
x = A⁻¹z
```

虽然这可能很难手工完成，但它是直接的，因此很容易由计算机完成。

在下一页中，我们将使用这些观察来描述自动生成矩阵的算法。

## 参考文献

- Rizzoni, G. (2007). Principles and Applications of Electrical Engineering. McGraw-Hill.
- DeCarlo, R. A., & Lin, P. M. (1995). Linear Circuit Analysis: Time Domain, Phasor, and Laplace Transform Approaches. Oxford University Press.
