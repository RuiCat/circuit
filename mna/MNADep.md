# 高级SCAM与受控源

本文档简要概述了如何在改进节点分析中容纳受控源。每种类型源的描述都很简短，但后面跟着一个示例。通过描述和示例，您应该能够弄清楚如何将受控源添加到您的模型中。如果需要，您可能想要回顾MNA算法（特别是各种矩阵和子矩阵的作用），以及如何使用SCAM程序。注意：示例网表（以及MATLAB代码）在GitHub上。

## 电压控制电压源（VCVS）- E

电压控制电压源（VCVS）在网表中定义，具有元素名称（以字母"E"开头），后跟两个输出节点（N+和N-）、两个控制节点（NC+和NC-）和增益值。输出电压设置为增益值乘以控制节点之间的差。
```
(v_N+ - v_N-) = Value · (v_NC+ - v_NC-)
```

```
Exxxxx N+ N- NC+ NC- Value
```

由于VCVS向电路添加了电压源，我们还需要添加一个新的未知数，即通过电压源的电流（因此B、C和D子矩阵都变得更大——如果需要，请回顾MNA算法）。回想一下，流出节点的电流被视为正。

### MNA矩阵的变化

- **j矩阵**：由于输出是电压源，我们将通过源的未知电流（I_Exxxxx）添加到矩阵j。
- **e矩阵**：添加一行，其中包含零以考虑新的受控电压源。
- **B矩阵**：我们为新的电压源向B矩阵添加一列，并在编号为"N+"和"N-"的行中添加+1和-1，以考虑添加到（或从）该节点的电流。
- **C矩阵**：我们为新的电压源添加一行。我们可以将上面的方程重写为：
  ```
  (v_N+ - v_N-) + Value · (v_NC- - v_NC+) = 0
  ```
  因此我们在"N+"对应的列中添加+1，在"N-"对应的列中添加"-1"。我们还在"NC-"对应的列中添加"+Value"（增益项），在"NC+"对应的列中添加"-Value"。

### 示例：

VCVS在所示电路中演示

带有VCCS的电路

我们可以用scam分析，您可以看到VCVS如何影响矩阵（网表显示在输出的顶部附近）。

```
>> scam

Netlist:
V1 1 0 12
R1 1 2 1000
R2 2 0 1000
R3 3 0 1000
Ea 3 2 1 2 g

The A matrix: 
[  1/R1,       -1/R1,    0, 1,  0]
[ -1/R1, 1/R1 + 1/R2,    0, 0, -1]
[     0,           0, 1/R3, 0,  1]
[     1,           0,    0, 0,  0]
[   -Ea,      Ea - 1,    1, 0,  0]

The x matrix: 
  v_1
  v_2
  v_3
 I_V1
 I_Ea

The z matrix:  
  0
  0
  0
 V1
  0

The matrix equation: 
            I_V1 + v_1/R1 - v_2/R1 == 0
 v_2*(1/R1 + 1/R2) - v_1/R1 - I_Ea == 0
                     I_Ea + v_3/R3 == 0
                              v_1 == V1
       v_3 - Ea*v_1 + v_2*(Ea - 1) == 0

The solution:  
                                                      v_1 == V1
 v_2 == (R2*V1*(R3 - Ea*R1))/(R1*R2 + R1*R3 + R2*R3 - Ea*R1*R2)
 v_3 == (R3*V1*(R2 + Ea*R1))/(R1*R2 + R1*R3 + R2*R3 - Ea*R1*R2)
     I_V1 == -(V1*(R2 + R3))/(R1*R2 + R1*R3 + R2*R3 - Ea*R1*R2)
  I_Ea == -(V1*(R2 + Ea*R1))/(R1*R2 + R1*R3 + R2*R3 - Ea*R1*R2)
```

如果您仔细观察，您会看到一个变量已添加到x矩阵中，用于通过VCVS的电流（标记为"I_Ea"），并且A矩阵的最后一行定义了VCVS的输入（控制）和输出电压之间的关系，有效地：
```
(v_3 - v_2) = Ea · (v_1 - v_2)
```

## 电压控制电流源（VCCS）- G

电压控制电流源（VCCS）在网表中定义，具有元素名称（以字母"G"开头），后跟两个输出节点（N+和N-）、两个控制节点（NC+和NC-）和增益值。输出电流设置为增益值乘以控制节点之间的差。节点N+和N-的电路方程（即每个节点的电流和为零）必须更改以考虑新电流：
```
节点 N+ : Value · (v_NC+ - v_NC-) + ∑(进入N+的其他电流) = 0
节点 N- : -Value · (v_NC+ - v_NC-) + ∑(进入N-的其他电流) = 0
```

```
Gxxxxx N+ N- NC+ NC- Value
```

回想一下，流出节点的电流被视为正。

### MNA矩阵的变化

唯一改变的矩阵是G矩阵。如果您检查上面的定义方程，您会看到在"G"与"N+"关联的行中，我们向与"NC+"关联的列添加"+Value"，向与"NC-"关联的节点添加"-Value"。在"G"与"N-"关联的行中，我们向与"NC+"关联的列添加"-Value"，向与"NC-"关联的节点添加"+Value"。

### 示例：

VCCS在所示电路中演示

带有VCCS的电路

我们可以用scam分析，您可以看到VCCS如何影响矩阵（网表显示在输出的顶部附近）。

```
>> scam

Netlist:
V1 1 0 12
R1 1 2 1000
R2 2 0 1000
R3 3 0 1000
Ga 3 2 1 2 g

The A matrix: 
[        1/R1,            -1/R1,    0, 1]
[ - Ga - 1/R1, Ga + 1/R1 + 1/R2,    0, 0]
[          Ga,              -Ga, 1/R3, 0]
[           1,                0,    0, 0]

The x matrix: 
  v_1
  v_2
  v_3
 I_V1

The z matrix:  
  0
  0
  0
 V1

The matrix equation: 
                   I_V1 + v_1/R1 - v_2/R1 == 0
 v_2*(Ga + 1/R1 + 1/R2) - v_1*(Ga + 1/R1) == 0
                 Ga*v_1 - Ga*v_2 + v_3/R3 == 0
                                     v_1 == V1

The solution:  
                                       v_1 == V1
 v_2 == (R2*V1*(Ga*R1 + 1))/(R1 + R2 + Ga*R1*R2)
      v_3 == -(Ga*R1*R3*V1)/(R1 + R2 + Ga*R1*R2)
                I_V1 == -V1/(R1 + R2 + Ga*R1*R2)
```

由于没有向电路添加新的电压源，矩阵大小不变，但是必须更改G子矩阵以考虑来自VCCS的电流。

## 电流控制电压源（CCVS）- H

对于电流控制电压源（CCCS），控制量是电流。您会记得，MNA算法计算的唯一电流是通过电压源的电流。因此，控制电流必须是通过其中一个电压源的电流。正是这个电压源在网表中用作控制元件——但请记住，重要的是通过电压源的电流。（注意：如果您需要的控制电流最初不是通过电压源的电流，您需要向电路添加一个零电压源（参见示例），以便计算该电流。）CCVS在网表中定义，具有元素名称（以字母"H"开头），后跟两个输出节点（N+和N-）、其电流是控制电流的电压源的名称和增益值。对于此元件，输出电压设置为增益值乘以控制电流。
```
(v_N+ - v_N-) = Value · I_Vxxxxx
```

```
Hxxxxx N+ N- Vxxxxx Value
```

由于CCVS向电路添加了电压源，我们还需要添加一个新的未知数，即通过电压源的电流（因此B、C和D子矩阵都变得更大——如果需要，请回顾MNA算法）。回想一下，流出节点的电流被视为正。

### MNA矩阵的变化

- **j矩阵**：由于输出是电压源，我们将通过源的未知电流（I_Exxxxx）添加到矩阵j。
- **e矩阵**：添加一行，其中包含零以考虑新的受控电压源。
- **B矩阵**：我们为新的电压源向B矩阵添加一列，并在编号为"N+"和"N-"的行中添加+1和-1，以考虑添加到（或从）该节点的电流。
- **C矩阵**：我们为新的电压源添加一行，我们在"N+"对应的列中添加+1，在"N-"对应的列中添加"-1"。
- **D矩阵**：在新电压源对应的行和控制源对应的列中，我们减去"Value"。这具有使该行对应于方程的效果：
  ```
  (v_N+ - v_N-) - Value · I_Vxxxxx = 0
  ```

### 示例：

CCVS的使用在所示电路中演示，其网表由以下给出：

带有VCCS的电路

我们可以用scam分析，您可以看到CCVS如何影响矩阵（网表显示在输出的顶部附近）。

```
>> scam


Netlist:
V1 1 0 12
R1 1 2 1000
R2 2 0 1000
R3 3 0 1000
Ha 3 2 V1 r

The A matrix: 
[  1/R1,       -1/R1,    0,   1,  0]
[ -1/R1, 1/R1 + 1/R2,    0,   0, -1]
[     0,           0, 1/R3,   0,  1]
[     1,           0,    0,   0,  0]
[     0,          -1,    1, -Ha,  0]

The x matrix: 
  v_1
  v_2
  v_3
 I_V1
 I_Ha

The z matrix:  
  0
  0
  0
 V1
  0

The matrix equation: 
            I_V1 + v_1/R1 - v_2/R1 == 0
 v_2*(1/R1 + 1/R2) - v_1/R1 - I_Ha == 0
                     I_Ha + v_3/R3 == 0
                               v_1 == V1
               v_3 - v_2 - Ha*I_V1 == 0

The solution:  
                                                 v_1 == V1
  v_2 == (R2*V1*(Ha + R3))/(R1*R2 + R1*R3 + R2*R3 + Ha*R2)
 v_3 == -(R3*V1*(Ha - R2))/(R1*R2 + R1*R3 + R2*R3 + Ha*R2)
   I_V1 == -(V1*(R2 + R3))/(R1*R2 + R1*R3 + R2*R3 + Ha*R2)
    I_Ha == (V1*(Ha - R2))/(R1*R2 + R1*R3 + R2*R3 + Ha*R2)
```

如您所见，B、C和D子矩阵已扩大以考虑新的未知变量（I_Ha，通过CCVS输出的电流），并且D矩阵已更改，使得最后一个方程有效地：
```
(v_3 - v_2) = Ha · I_V1
```

如所需。

## 电流控制电流源（CCCS）- F

对于电流控制电流源（CCCS），控制量是电流。您会记得，MNA算法计算的唯一电流是通过电压源的电流。因此，控制电流必须是通过其中一个电压源的电流。正是这个电压源在网表中用作控制元件——但请记住，重要的是通过电压源的电流。（注意：如果您需要的控制电流最初不是通过电压源的电流，您需要向电路添加一个零电压源（参见示例），以便计算该电流。）CCCS在网表中定义，具有元素名称（以字母"F"开头），后跟两个输出节点（N+和N-）、其电流是控制电流的电压源的名称和增益值。对于此元件，输出电流设置为增益值乘以控制电流。节点N+和N-的电路方程（即每个节点的电流和为零）必须更改以考虑新电流（在此方程中，"I_Vxxxxx"是通过电压源"Vxxxxx"的电流（在网表中其他地方定义））：
```
节点 N+ : Value · I_Vxxxxx + ∑(进入N+的其他电流) = 0
节点 N- : -Value · I_Vxxxxx + ∑(进入N-的其他电流) = 0
```

```
Fxxxxx N+ N- Vxxxxx Value
```

回想一下，流出节点的电流被视为正。

### MNA矩阵的变化

只有B矩阵改变。对于此元件，我们需要向节点"N+"添加等于"Value·I_Vxxxxx"的电流，并从节点"N-"中减去它。为此，我们找到对应于电压源"Vxxxxx"的B的列。我们向此列的"N+"行添加"Value"（以便它乘以"I_Vxxxxx"），这有效地向该节点添加"Value·I_Vxxxxx"。同样，我们从B的同一列的"N-"行中减去"Value"。

### 示例：

CCCS的使用在所示电路中演示，其网表由以下给出（在这种情况下，控制电流是通过"V1"的电流）：

带有VCCS的电路

我们可以用scam分析，您可以看到CCCS如何影响矩阵（网表显示在输出的顶部附近）。

```
>> scam

Netlist:
V1 1 0 12
R1 1 2 1000
R2 2 0 1000
R3 3 0 1000
Fa 3 2 V1 f

The A matrix: 
[  1/R1,       -1/R1,    0,   1]
[ -1/R1, 1/R1 + 1/R2,    0, -Fa]
[     0,           0, 1/R3,  Fa]
[     1,           0,    0,   0]

The x matrix: 
  v_1
  v_2
  v_3
 I_V1

The z matrix:  
  0
  0
  0
 V1

The matrix equation: 
               I_V1 + v_1/R1 - v_2/R1 == 0
 v_2*(1/R1 + 1/R2) - v_1/R1 - Fa*I_V1 == 0
                     v_3/R3 + Fa*I_V1 == 0
                                 v_1 == V1

The solution:  
                                  v_1 == V1
 v_2 == -(R2*V1*(Fa - 1))/(R1 + R2 - Fa*R2)
        v_3 == (Fa*R3*V1)/(R1 + R2 - Fa*R2)
              I_V1 == -V1/(R1 + R2 - Fa*R2)
```

注意B子矩阵的变化，它考虑了添加到（或从）输出节点的电流。

## 网表中受控源的总结

| 源类型 | 符号 | 网表格式 | 主要影响 |
|--------|------|----------|----------|
| VCVS | E | Exxxxx N+ N- NC+ NC- Value | 添加电压源，修改C矩阵 |
| VCCS | G | Gxxxxx N+ N- NC+ NC- Value | 修改G矩阵 |
| CCVS | H | Hxxxxx N+ N- Vxxxxx Value | 添加电压源，修改D矩阵 |
| CCCS | F | Fxxxxx N+ N- Vxxxxx Value | 修改B矩阵 |

## 参考文献

- Litovski, V. (2007). Lecture Notes on Electronic Circuits. University of Niš.
